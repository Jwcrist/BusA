library(RCurl)
dataset<-getURL(
'https://raw.githubusercontent.com/Jwcrist/BusA/master/homeworks/Assignment%204/Auto.csv',
ssl.verifypeer=0L, followlocation=1L)
dataset1<-read.csv(text=dataset)
head(dataset1,3)
library(dplyr)
dataset2<-dataset1 %>%
select(mpg, cylinders, displacement, as.numeric(horsepower), weight, acceleration, year, origin, mpg01)
dataset2$horsepower <- gsub("?",NA,dataset2$horsepower, fixed = TRUE)
dataset2$horsepower <- as.numeric(dataset2$horsepower)
str(dataset2)
cor(na.omit(dataset2))
pairs(dataset1)
library(ggplot2)
ggplot(dataset1, aes(x=factor(mpg01), y=mpg))+geom_boxplot()
ggplot(dataset1, aes(x=factor(mpg01), y=cylinders))+geom_boxplot()
ggplot(dataset1, aes(x=factor(mpg01), y=displacement))+geom_boxplot()
ggplot(dataset1, aes(x=factor(mpg01), y=weight))+geom_boxplot()
ggplot(dataset1, aes(x=factor(mpg01), y=acceleration))+geom_boxplot()
ggplot(dataset1, aes(x=factor(mpg01), y=year))+geom_boxplot()
pairs(dataset1)
ggplot(dataset1, aes(x=factor(mpg01), y=year))+geom_boxplot()
tail(dataset1)
trainingdata<-dataset1[1:318,]
testdata<-dataset1[79,]
dim(testdata)
tail(dataset1)
579/(579+451)
451/(579+451)
26/(26+33)
33/(26+33)
26/(26+33)
(26+33)/(26+33+579+451)
library(MASS)
library(ISLR)
library(ggplot2)
tail(Weekly, 1)
summary(Weekly)
data1<-Weekly[,1:8]
attach(Weekly)
cor(data1)
pairs(data1)
glm.fit=glm(Direction~Lag1+Lag2+Lag3+Lag4+Lag5+Volume,data=Weekly, family = binomial)
summary(glm.fit)
coef(glm.fit)
contrasts(Direction)
glm.pred=rep("Down", 1089)
glm.probs=predict(glm.fit,type="response")
glm.probs[1:10]
glm.pred[glm.probs>0.5]<-"Up"
table(glm.pred,Direction)
557/(557+430)
430/(557+430)
48/(48+54)
glm.fit2=glm(Direction~Lag2,data=Weekly, family = binomial)
summary(glm.fit2)
coef(glm.fit2)
contrasts(Direction)
glm.pred2=rep("Down", 1089)
glm.probs2=predict(glm.fit2,type="response")
glm.probs2[1:10]
glm.pred2[glm.probs2>0.5]<-"Up"
table(glm.pred2,Direction)
579/(579+451)
451/(26+451)
26/(26+451)
table(glm.pred,Direction)
(54+557)/(557+430)
430/(48+430)
48/(48+430)
table(glm.pred2,Direction)
(33+579)/(579+451)
