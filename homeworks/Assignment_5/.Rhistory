tree.OJ=tree(Purchase~., train2)
tail(OJ, 3)
library(MASS)
library(dplyr)
library(ISLR)
library(caret)
library(tree)
tail(OJ, 3)
800/1070
attach(OJ)
set.seed(5432)
DataIndex2<-createDataPartition(OJ$Purchase, p = 0.747, list=FALSE, times=1)
train2<-OJ[DataIndex2,]
OJ.test<-OJ[-DataIndex2,]
dim(train2)
dim(OJ.test)
tree.OJ=tree(Purchase~., train2,cex = 0.6)
tree.OJ=tree(Purchase~., train2)
summary(tree.OJ)
tree.OJ
attach(Carseats)
High = ifelse (Sales <= 8,"No", "Yes")
Carseats = data.frame(Carseats, High)
head(Carseats)
set.seed(2345)
DataIndex<-createDataPartition(Carseats$Sales, p = 0.8, list=FALSE, times=1)
train<-Carseats[DataIndex,]
Carseats.test<-Carseats[-DataIndex,]
High.test=High[-DataIndex]
dim(Carseats)
dim(train)
dim(Carseats.test)
str(Carseats)
tree.carseats=tree(High~.-Sales, Carseats)
summary(tree.carseats)
plot(tree.carseats)
text(tree.carseats, pretty = 0)
text(tree.carseats, pretty = 0,cex=0.8)
plot(tree.carseats)
text(tree.carseats, pretty = 0,cex=0.8)
plot(tree.carseats)
text(tree.carseats, pretty = 0,cex=0.6)
plot(tree.carseats)
text(tree.carseats, pretty = 0,cex=0.6,srt=60)
text(tree.carseats, pretty = 0,cex=0.6,srt=90)
plot(tree.carseats)
text(tree.carseats, pretty = 0,cex=0.6,srt=90)
plot(tree.carseats)
text(tree.carseats, pretty = 0,cex=0.6,srt=85)
plot(tree.carseats)
text(tree.carseats, pretty = 0,cex=0.6,srt=75)
str(Carseats)
tree.carseats=tree(High~.-Sales, Carseats)
summary(tree.carseats)
plot(tree.carseats)
text(tree.carseats, pretty = 0,cex=0.6,srt=75)
tree.carseats
set.seed (2)
tree.carseats =tree(High~.-Sales, train)
tree.pred=predict(tree.carseats, Carseats.test, type = 'class' )
table(tree.pred, High.test)
(59)/79
set.seed (3)
cv.carseats =cv.tree(tree.carseats ,FUN=prune.misclass )
names(cv.carseats )
cv.carseats
par(mfrow =c(1,2))
plot(cv.carseats$size ,cv.carseats$dev ,type="b")
plot(cv.carseats$k ,cv.carseats$dev ,type="b")
prune.carseats =prune.misclass (tree.carseats ,best =9)
plot(prune.carseats )
text(prune.carseats ,pretty =0,cex=0.6,srt=75)
tree.pred=predict (prune.carseats , Carseats.test ,type="class")
table(tree.pred ,High.test)
prune.carseats =prune.misclass (tree.carseats ,best =15)
plot(prune.carseats )
text(prune.carseats ,pretty =0,cex=0.6,srt=75)
plot(prune.carseats )
text(prune.carseats ,pretty =0,cex=0.5,srt=75)
text(prune.carseats ,pretty =0,cex=0.5,srt=75)
plot(prune.carseats )
text(prune.carseats ,pretty =0,cex=0.5,srt=75)
plot(prune.carseats )
text(prune.carseats ,pretty =0,cex=0.75,srt=75)
tail(OJ, 3)
800/1070
attach(OJ)
set.seed(5432)
DataIndex2<-createDataPartition(OJ$Purchase, p = 0.747, list=FALSE, times=1)
train2<-OJ[DataIndex2,]
OJ.test<-OJ[-DataIndex2,]
dim(train2)
dim(OJ.test)
tree.OJ=tree(Purchase~., train2)
summary(tree.OJ)
tree.OJ
plot(tree.OJ)
text(tree.OJ,pretty =0,cex=0.6,srt=75)
tree.pred=predict(tree.OJ, OJ.test, type = 'class' )
table(tree.pred)
tree.pred
tree.pred2=predict(tree.OJ, OJ.test, type = 'class' )
tree.pred
table(tree.pred2,High.test2)
tree.pred2=predict(tree.OJ, OJ.test, type = 'class' )
table(tree.pred2,High.test2)
table(tree.pred2)
summary(tree.OJ)
tail(OJ, 3)
?OJ
tree.OJ=tree(Purchase~.,OJ,subset= train2)
tree.OJ=tree(Purchase~.,subset= train2)
tree.OJ=tree(Purchase~.,train2)
summary(tree.OJ)
table(tree.pred2,Purchase)
table(tree.pred2,test.Purchase)
table(tree.pred2,test$Purchase)
table(tree.pred2,OJ.test$Purchase)
cv.OJ =cv.tree(tree.OJ ,FUN=prune.misclass )
names(cv.OJ)
cv.OJ
par(mfrow =c(1,2))
plot(cv.OJ$size ,cv.OJ$dev ,type="b")
plot(cv.OJ$k ,cv.OJ$dev ,type="b")
tree.OJ
?OJ
plot(tree.OJ)
text(tree.OJ,pretty =0,cex=0.6,srt=75)
plot(tree.OJ)
text(tree.OJ,pretty =0,cex=0.6,srt=75)
tail(OJ, 3)
800/1070
attach(OJ)
set.seed(5432)
DataIndex2<-createDataPartition(OJ$Purchase, p = 0.747, list=FALSE, times=1)
train2<-OJ[DataIndex2,]
OJ.test<-OJ[-DataIndex2,]
dim(train2)
dim(OJ.test)
tree.OJ=tree(Purchase~.,train2)
summary(tree.OJ)
tree.OJ
plot(tree.OJ)
text(tree.OJ,pretty =0,cex=0.6,srt=75)
plot(tree.OJ)
text(tree.OJ,pretty =0,cex=0.6,srt=75)
tree.pred2=predict(tree.OJ, OJ.test, type = 'class' )
table(tree.pred2,OJ.test$Purchase)
?OJ
plot(tree.OJ)
text(tree.OJ,pretty =0,cex=0.6,srt=75)
tree.pred2=predict(tree.OJ, OJ.test, type = 'class' )
table(tree.pred2,OJ.test$Purchase)
154+42+11+63
(154+63)/270
